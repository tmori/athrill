
		TOPPERS/ATK2-SC1
        ＜RH850_PBターゲット依存部(GHS版)マニュアル＞

このドキュメントはRH850_PBターゲット依存部の情報を記述したものである．

----------------------------------------------------------------------
TOPPERS ATK2
    Toyohashi Open Platform for Embedded Real-Time Systems
    Automotive Kernel Version 2

Copyright (C) 2013-2014 by Center for Embedded Computing Systems
            Graduate School of Information Science, Nagoya Univ., JAPAN
Copyright (C) 2013-2014 by FUJISOFT INCORPORATED, JAPAN

上記著作権者は，以下の (1)～(3)の条件を満たす場合に限り，本ドキュメ
ント（本ドキュメントを改変したものを含む．以下同じ）を使用・複製・改
変・再配布（以下，利用と呼ぶ）することを無償で許諾する．
(1) 本ドキュメントを利用する場合には，上記の著作権表示，この利用条件
    および下記の無保証規定が，そのままの形でドキュメント中に含まれて
    いること．
(2) 本ドキュメントを改変する場合には，ドキュメントを改変した旨の記述
    を，改変後のドキュメント中に含めること．ただし，改変後のドキュメ
    ントが，TOPPERSプロジェクト指定の開発成果物である場合には，この限
    りではない．
(3) 本ドキュメントの利用により直接的または間接的に生じるいかなる損害
    からも，上記著作権者およびTOPPERSプロジェクトを免責すること．また，
    本ドキュメントのユーザまたはエンドユーザからのいかなる理由に基づ
    く請求からも，上記著作権者およびTOPPERSプロジェクトを免責すること．

本ドキュメントは，AUTOSAR（AUTomotive Open System ARchitecture）仕様
に基づいている．上記の許諾は，AUTOSARの知的財産権を許諾するものではな
い．AUTOSARは，AUTOSAR仕様に基づいたソフトウェアを商用目的で利用する
者に対して，AUTOSARパートナーになることを求めている．

本ドキュメントは，無保証で提供されているものである．上記著作権者およ
びTOPPERSプロジェクトは，本ドキュメントに関して，特定の使用目的に対す
る適合性も含めて，いかなる保証も行わない．また，本ドキュメントの利用
により直接的または間接的に生じたいかなる損害に関しても，その責任を負
わない．

$Id: target_user.txt 46 2014-07-19 15:40:08Z ertl-honda $
----------------------------------------------------------------------

○概要

RH850_PBターゲット依存部（RH850_PB依存部）は，ルネサスエレクトロニ
クス社のRH850/F1Hを搭載したルネサスエレクトロニクス社プラットホームボ
ードをサポートしている．


○動作確認バージョン

動作確認を行ったコンパイラのバージョンはプロセッサ依存部のユーザーマニ
ュアルに記載している．


○コア指定

次の3種類の実行パターンをサポートしている．それぞれ指定はMakefile中で
PE_CONFIGに以下の値を設定することで指定可能である．

1.PE1のみ実行 : PE1_ONLY
  ・PE2は無限ループ
  
2.PE2のみ実行 : PE2_ONLY
  ・PE1は無限ループ
  
3.両方のコアで実行．
 3.1 PE1用 : DUAL_PE1
 3.2 PE2用 : DUAL_PE2


○ログ出力

ログ出力のためのUARTEはポート3を使用する．使用するユニット番号やポート
番号は，以下のマクロを定義することで指定する．
 
ポート番号
 ポート0 : DRLIN3x_USE_PORT0
 ポート1 : DRLIN3x_USE_PORT1

データフォーマットは，

・115200bps、データ8bit、パリティなし、ストップ1bit、フロー制御なし

である．


○サンプルプログラムで用いるタイマ

・サンプルプログラムにて，TAUJ0ないしTAUJ1を使用．
  どちらを使用するかはMakefile中のマクロを指定可能

   TAUJ0 : HWC_USE_UNIT0
   TAUJ1 : HWC_USE_UNIT1
 
・1個のカウンタに2つのタイマを使用している．
    差分タイマ：目的の時間を設定する時の現在時間(現在値タイマ)と次の満
    了時間との相対時間をカウントすることで目的の絶対時間に満了したこと
    とする.
        count mode:count down once
    現在値タイマ：カウンタ周期分のベースタイマを実現(絶対時間をカウント)
        count mode:continuous count down
・使用カウンタ情報
    カウンタ名：MAIN_HW_COUNTER
        差分タイマ：TAUJ0
        現在値タイマ：TAUJ1
        1ティック当たりの秒数：1/TIMER_CLOCK_HZ
 
○ビルド環境

ビルド環境はWindows上のCygwinを使用する．Cygwinには最低限以下のパッケ
ージをインストールする必要がある．

 ・make
 ・perl
 
Makefileの雛形はsample以下のものではなく， ./arch/v850_ghs/Makefile.sample 
をsample以下にMakefileとしてコピーして使用すること．
 
○デバッグ環境

動作確認はCS+で実施した．CS+の設定方法は次の通りである．

 1) CubeSuite+を起動
 2) 新規プロジェクトを作成．
    メニューから[ファイル] → [新規作成] → [新しいプロジェクトを作成]を選択
 3) プロジェクトの作成
  プロジェクト作成ダイアログ内で以下の設定をします。
   [1] マイクロコントローラ        ：RH850を選択
   [2] 使用するマイクロコントローラ：R7F701503
   [3] プロジェクトの種類          ：デバック専用
   [4] プロジェクト名              ：任意
   [5] 作成場所                    ：任意
   [6] OKを選択
   上記[5]で指定したフォルダ内にプロジェクト名.mtpjファイルが作成される．
 4) デバックツールの選択
   [1] 画面左側ツリー内のRH850シュミレータを選択し右クリック
   [2] 使用するデバックツールを選択
   [3] 接続用設定のタブを選択
   [4] メイン・クロック周波数 に 16 を指定
 5) ダウンロードファイルの設定
   [1] 画面右側のタブから[ダウンロード・ファイル設定]を選択
   [2] 画面右側のダウンロードするファイルを選択
   [3] 選択行右端[...]を左クリック
   [4] ダウンロード・ダイアログ内で[追加]ボタンを選択
   [5] ダウンロード・ファイル情報のファイルを選択後[...]を左クリック
   [6] ダウンロードファイルは[atk-sc1.exe]を選択
   [7] OKを選択
 6) ファイルをダウンロード
   [1] ターゲットボードの電源をON
   [2] メニューから[デバック]→[デバック・ツールへダウンロード]を選択
 7) プログラムの実行
   [1] メニューから[デバック]→[リスタート]を選択
      ターミナル画面に[Input Command:]と表示が出れば正常に動作している ．
 上記手順の 2)～5)は新規にプロジェクトを作成した時のみ実行．
 

○変更履歴
2015/04/07
・taget_test.h
  COUNTER_MIN_CYCLEの定義を追加．

2013/11/10
 新規作成
 
以上 
